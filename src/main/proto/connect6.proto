syntax = "proto3";

package connect6;

option java_multiple_files = true;
option java_package = "connect6.grpc";
option java_outer_classname = "Connect6Proto";

message PlayerInfo {
    string name = 1;
}

message Move {
    string player = 1;
    int32 x = 2;
    int32 y = 3;
}

message MoveResult {
    bool success = 1;
    string message = 2;
}

message RematchRequest {
    string player = 1;
}

message DisconnectRequest {
    string player = 1;
}

message Row {
    repeated string cells = 1;
}

message Board {
    repeated Row rows = 1;
}

message GameEvent {
    oneof payload {
        Board board = 1;
        string winner = 2;
        string currentTurn = 3;
        string role = 4;
    }
}

service Connect6Game {
    rpc Register(PlayerInfo) returns (stream GameEvent);
    rpc MakeMove(Move) returns (MoveResult);
    rpc RequestRematch(RematchRequest) returns (MoveResult);
    rpc Disconnect(DisconnectRequest) returns (MoveResult);
}
